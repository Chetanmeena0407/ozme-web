<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>OZME Batches</title>

<style>
body { font-family: Arial, sans-serif; margin:0; padding:0; background:#0f111a; color:#fff; overflow-x:hidden; }

#logoOverlay {
  position: fixed; inset:0;
  display:flex; justify-content:center; align-items:center; flex-direction: column;
  background: radial-gradient(circle at center, #05060a 0%, #0b1220 100%);
  z-index: 9999;
}
#logoOverlay h1 {
  font-size: clamp(50px, 15vw, 120px);
  font-weight: 900;
  background: linear-gradient(90deg,#ff4760,#ff9f43,#1e90ff);
  -webkit-background-clip:text;
  color: transparent;
  opacity:0;
  transform: scale(0.3);
  animation: showLogo 2.5s forwards;
}
#logoOverlay p { margin-top:20px; opacity:0; animation: fadeUp 1s 2.5s forwards; }

@keyframes showLogo { to {opacity:1; transform:scale(1);} }
@keyframes fadeUp { to {opacity:1;} }

#batches { opacity:0; padding:20px; transition:1s; }
h1 { text-align:center; }

#searchBar {
  display:block; margin:0 auto 20px;
  padding:10px; width:80%; max-width:400px;
  background:#1c1f2b; color:#fff;
  border:2px solid #6c63ff; border-radius:8px;
}

.batch-container {
  display:grid;
  grid-template-columns: repeat(auto-fit,minmax(250px,1fr));
  gap:20px;
}

.batch-card {
  background:#1c1f2b;
  border-radius:12px;
  overflow:hidden;
  box-shadow:0 4px 12px rgba(0,0,0,.5);
  transition:.3s;
  position:relative;
}
.batch-card:hover { transform:translateY(-6px); }

.batch-card img { width:100%; }

.content { padding:15px; }
.footer { padding:15px; text-align:center; }
.footer a {
  background:#6c63ff; color:#fff;
  padding:10px 20px;
  border-radius:10px;
  text-decoration:none;
}

.fav-btn {
  position:absolute; top:10px; right:10px;
  background:#1c1f2b; border:none;
  border-radius:50%; width:35px; height:35px;
  font-size:18px; cursor:pointer;
}
.fav-btn.active { color:#ff6b6b; }
</style>
</head>

<body>

<div id="logoOverlay">
  <h1>OZME</h1>
  <p>Next Gen Learning Platform</p>
</div>

<div id="batches">
  <h1>OZME Batches</h1>
  <input id="searchBar" placeholder="üîç Search batches">

  <div id="favoritesSection" style="display:none">
    <h2>‚≠ê Favorites</h2>
    <div class="batch-container" id="favoritesContainer"></div>
  </div>

  <div class="batch-container" id="allBatches"></div>
</div>

<!-- üî• FIREBASE DYNAMIC BATCH LOADER -->
<script type="module">
import { db } from "./firebase.js";
import { ref, onValue } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-database.js";

const allBatches = document.getElementById("allBatches");

onValue(ref(db,"batches"), snap => {
  allBatches.innerHTML="";
  const data = snap.val();
  if(!data) return;

  for(const id in data){
    const b = data[id];
    allBatches.innerHTML += `
      <div class="batch-card" data-title="${b.batchName}">
        <button class="fav-btn">‚≠ê</button>
        <img src="${b.image || 'https://via.placeholder.com/300'}">
        <div class="content">
          <h2>${b.batchName}</h2>
          <p class="price">‚ÇπFREE</p>
        </div>
        <div class="footer">
          <a href="verify.html?redirect=batch.html?batch=${id}">
            Let's Study
          </a>
        </div>
      </div>`;
  }
  initFavorites();
});
</script>

<!-- üü¢ UI + SEARCH + FAVORITES -->
<script>
setTimeout(()=>{
  logoOverlay.style.display="none";
  batches.style.opacity=1;
},4000);

searchBar.addEventListener("input",()=>{
  const v = searchBar.value.toLowerCase();
  document.querySelectorAll(".batch-card").forEach(c=>{
    c.style.display = c.dataset.title.toLowerCase().includes(v)?"block":"none";
  });
});

function initFavorites(){
  const favSec = document.getElementById("favoritesSection");
  const favCon = document.getElementById("favoritesContainer");
  const cards = document.querySelectorAll(".batch-card");
  let favs = JSON.parse(localStorage.getItem("favs"))||[];

  favCon.innerHTML="";
  cards.forEach(c=>{
    const btn=c.querySelector(".fav-btn");
    const t=c.dataset.title;

    if(favs.includes(t)){ btn.classList.add("active"); btn.textContent="‚ù§Ô∏è"; }

    btn.onclick=()=>{
      if(favs.includes(t)){
        favs=favs.filter(x=>x!==t);
        btn.classList.remove("active"); btn.textContent="‚≠ê";
      }else{
        favs.push(t);
        btn.classList.add("active"); btn.textContent="‚ù§Ô∏è";
      }
      localStorage.setItem("favs",JSON.stringify(favs));
      initFavorites();
    };
  });

  favs.forEach(t=>{
    const c=[...cards].find(x=>x.dataset.title===t);
    if(c) favCon.appendChild(c.cloneNode(true));
  });
  favSec.style.display = favs.length?"block":"none";
}
</script>

</body>
</html>
